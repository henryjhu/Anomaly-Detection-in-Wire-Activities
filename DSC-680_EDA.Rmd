---
title: "**DSC-680-Z1 Research Practicum** <br> Exploratory Data Analysis"
output: html_document
---
## **Project Description**
The research practicum involves on-site experiential learning in a research setting. This setting may be in the private or public sector, it may include such locations as education, governmental, non-governmental, or general
research organization. The experience must provide students the opportunity to collect and analyze data, consider ethical implications of research, and draw empirically grounded conclusions.

<b>Purpose:</b><br>
Carry out exploratory data analysis on a set of random sample data extracted for machine learning.<br>
<b>Universtiy Name:</b> Utica College <br>
<b>Course Name:</b> DSC-680-Z1 Research Practicum <br>
<b>Student Name:</b> Henry J. Hu <br>
<b>Program Director Name:</b> Dr. McCarthy, Michael <br>
<b>Runtime Environment:</b> RStudio<br>
<b>Programming Language:</b> R <br>
<b>Original Data Frame:</b>
12,705,553 international wires belonging to 139 customers from 3 continents for the entire year of 2020.<br>
<b> Last Update:</b> July 21st, 2021

## **Clearing R Studio Memory Usage**

```{r, echo=TRUE, message=FALSE}
gc()
rm(list = ls())
```

## **Time Counter Start**
```{r, echo=TRUE, message=FALSE}
start_time <- Sys.time()
```

## **Include the knitr package for integration of R code into Markdown**

```{r, echo = TRUE}
knitr::opts_chunk$set(echo = TRUE)
```

## **All the libraries used in this code**
```{r, echo=TRUE, message=FALSE}
library(easypackages)
libraries("caret","caretEnsemble","caTools","class","cluster","data.tree","devtools","doSNOW","dplyr","e1071","factoextra","gbm","FNN","FSelector","ggalt","ggforce","ggfortify","ggplot2","gmodels","klaR","lattice","mlbench","modeest","nnet","neuralnet","outliers","parallel","psych","purrr","readr","rpart","rpart.plot","spatialEco","stats","tidyr","randomForest","ROSE","rsample","ROCR","pROC","glmnet","gridExtra","R6","Epi") 
```

## **Import data into RStudio**

```{r, echo=TRUE, message=FALSE}
# input_data <- read_delim("Final_cleaned_data.txt", ",", escape_double = FALSE, col_types = cols(
#               TRANSACTION_ID = col_character(), 
#               TRANSACTION_TIME = col_datetime(),
#               TRXN_MONTH = col_character(),
#               CLIENT_ID = col_character(), 
#               COUNTRY_NAME = col_character(), 
#               COUNTRY_CODE = col_character(), 
#               CONTINENT_NAME = col_character(), 
#               CONTINENT_CODE = col_character(), 
#               SWIFT_MSG_TYPE = col_character(), 
#               AVG_TRXN_AMT = col_double(),
#               TRANSACTION_AMOUNT = col_double()   
#               ),
#     trim_ws = TRUE)
```


## **Sample data for data exploratory analysis**

This sample data is for exploratory data analysis only.

```{r, echo=TRUE, message=FALSE}
# Sample the data
# input_data_4M <- input_data_4M[sample(nrow(input_data), 4000000), ]

# Write data to storage
# write.table(input_data_4M, file="sample_df_4M.txt", append = FALSE, sep = "\t", dec = ".", row.names = FALSE, col.names = TRUE)

# Load data into data frame
input_data_eda <- read_delim("sample_df_4M.txt", ",", escape_double = FALSE, col_types = cols(
              TRANSACTION_ID = col_character(), 
              TRANSACTION_TIME = col_datetime(),
              TRXN_MONTH = col_character(),
              CLIENT_ID = col_character(), 
              COUNTRY_NAME = col_character(), 
              COUNTRY_CODE = col_character(), 
              CONTINENT_NAME = col_character(), 
              CONTINENT_CODE = col_character(), 
              SWIFT_MSG_TYPE = col_character(), 
              AVG_TRXN_AMT = col_double(),
              TRANSACTION_AMOUNT = col_double()   
              ),
    trim_ws = TRUE)
```

## **Sample data for data for plotting**

This sample data is for plotting only.

```{r, echo=TRUE, message=FALSE}
# Sample the data
# input_data_100K <- input_data_100K[sample(nrow(input_data), 100000), ]

# Write data to storage
# write.table(input_data_100K, file="sample_df_100K.txt", append = FALSE, sep = "\t", dec = ".", row.names = FALSE, col.names = TRUE)

# Load data into data frame
input_data_plot <- read_delim("sample_df_100K.txt", ",", escape_double = FALSE, col_types = cols(
              TRANSACTION_ID = col_character(), 
              TRANSACTION_TIME = col_datetime(),
              TRXN_MONTH = col_character(),
              CLIENT_ID = col_character(), 
              COUNTRY_NAME = col_character(), 
              COUNTRY_CODE = col_character(), 
              CONTINENT_NAME = col_character(), 
              CONTINENT_CODE = col_character(), 
              SWIFT_MSG_TYPE = col_character(), 
              AVG_TRXN_AMT = col_double(),
              TRANSACTION_AMOUNT = col_double()   
              ),
    trim_ws = TRUE)
```
## **Descriptive Statistics** 

These descriptive statistics reveal both the central tendency and dispersion tendency of the sample data for machine learning.

### **Dimension of data frame**
```{r, echo=TRUE, message=FALSE}
dim(input_data_eda)
```
### **Structure of data frame** 
```{r, echo=TRUE, message=FALSE}
str(input_data_eda)
```
### **Summary statistics of data frame**
```{r, echo=TRUE, message=FALSE}
summary(input_data_eda)
```
### **Glimpse of data frame** 
```{r, echo=TRUE, message=FALSE}
glimpse(input_data_eda)
```
### **Head of data frame** 
```{r, echo=TRUE, message=FALSE}
head(input_data_eda)
```
### **Tail of data frame**
```{r, echo=TRUE, message=FALSE}
tail(input_data_eda)
```

## **Segegrate and prepare data for plotting** 

```{r, echo=TRUE, message=FALSE}

input_data_plot$TRANSACTION_AMOUNT=input_data_plot$TRANSACTION_AMOUNT/1000

input_data_plot <- input_data_plot %>%
  mutate(MONTH_TEXT = case_when(
    endsWith(TRXN_MONTH, "1") ~ "Jan",
    endsWith(TRXN_MONTH, "2") ~ "Feb",
    endsWith(TRXN_MONTH, "3") ~ "Mar",
    endsWith(TRXN_MONTH, "4") ~ "Apr",
    endsWith(TRXN_MONTH, "5") ~ "May",
    endsWith(TRXN_MONTH, "6") ~ "Jun",
    endsWith(TRXN_MONTH, "7") ~ "Jul",
    endsWith(TRXN_MONTH, "8") ~ "Aug",
    endsWith(TRXN_MONTH, "9") ~ "Sep",
    endsWith(TRXN_MONTH, "10") ~ "Oct",
    endsWith(TRXN_MONTH, "11") ~ "Nov",
    endsWith(TRXN_MONTH, "12") ~ "Dec"
    ))

NN_103_df <- input_data_plot[input_data_plot$CONTINENT_CODE	=='NN' & input_data_plot$SWIFT_MSG_TYPE=='103',]
NN_103_df$TRXN_MONTH = as.integer(NN_103_df$TRXN_MONTH)
NN_103_df <- NN_103_df[order(NN_103_df$TRXN_MONTH),]
glimpse(NN_103_df)
dim(NN_103_df)

NN_202_df <- input_data_plot[input_data_plot$CONTINENT_CODE	=='NN' & input_data_plot$SWIFT_MSG_TYPE=='202',]
NN_202_df$TRXN_MONTH = as.integer(NN_202_df$TRXN_MONTH)
NN_202_df <- NN_202_df[order(NN_202_df$TRXN_MONTH),]
glimpse(NN_202_df)
dim(NN_202_df)

EU_103_df <- input_data_plot[input_data_plot$CONTINENT_CODE	=='EU' & input_data_plot$SWIFT_MSG_TYPE=='103',]
EU_103_df$TRXN_MONTH = as.integer(EU_103_df$TRXN_MONTH)
EU_103_df <- EU_103_df[order(EU_103_df$TRXN_MONTH),]
glimpse(EU_103_df)
dim(EU_103_df)

EU_202_df <- input_data_plot[input_data_plot$CONTINENT_CODE	=='EU' & input_data_plot$SWIFT_MSG_TYPE=='202',]
EU_202_df$TRXN_MONTH = as.integer(EU_202_df$TRXN_MONTH)
EU_202_df <- EU_202_df[order(EU_202_df$TRXN_MONTH),]
head(EU_202_df)
dim(EU_202_df)

AS_103_df <- input_data_plot[input_data_plot$CONTINENT_CODE	=='AS' & input_data_plot$SWIFT_MSG_TYPE=='103',]
AS_103_df$TRXN_MONTH = as.integer(AS_103_df$TRXN_MONTH)
AS_103_df <- AS_103_df[order(AS_103_df$TRXN_MONTH),]
glimpse(AS_103_df)
dim(AS_103_df)

AS_202_df <- input_data_plot[input_data_plot$CONTINENT_CODE	=='AS' & input_data_plot$SWIFT_MSG_TYPE=='202',]
AS_202_df$TRXN_MONTH = as.integer(AS_202_df$TRXN_MONTH)
AS_202_df <- AS_202_df[order(AS_202_df$TRXN_MONTH),]
glimpse(AS_202_df)
dim(AS_202_df)

```

## **Pie Chart**

North America has the most number of wire tranfers.

```{r p3, echo=TRUE, message=FALSE}

  library(plotly)

  input_data_plot$pie_count = 1
  
  input_data_plot$CONTINENT_NAME <-  factor(input_data_plot$CONTINENT_NAME, levels=unique(input_data_plot$CONTINENT_NAME))

  plot_ly(input_data_plot, 
          labels = ~CONTINENT_NAME, 
          values = ~pie_count, 
          type = 'pie',
          textposition = 'inside',
          textinfo = 'label+percent',
          insidetextfont = list(color = '#FFFFFF'),
          marker = list(colors = colors,line = list(color = '#FFFFFF', width = 2)),
          showlegend = TRUE)  %>%
  layout(title='<b>Transaction % by Continent</b>',
         xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
         yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
```

## **Bar Plot**

These bar plots reveal the average monthly transaction amounts for each cohort of continent, SWIFT message type and month. 

```{r p4, echo=TRUE, message=FALSE}
library(ggplot2)

options(repr.plot.width = 15, repr.plot.height = 10)

NN_103_df$MONTH_TEXT <-  factor(NN_103_df$MONTH_TEXT, levels=unique(NN_103_df$MONTH_TEXT))
ggplot(NN_103_df, aes(x = MONTH_TEXT, y = TRANSACTION_AMOUNT)) + 
geom_bar(stat = "summary", fun = "mean", fill='#5DADE2', color="#000000") +
ggtitle("North America MT103 Monthly Average Transaction Amount") +
xlab("Month") +
ylab("Average Transaction Amount (Thousands)") +
theme(axis.text=element_text(size=10),
      axis.title = element_text(size=10),
      plot.title = element_text(hjust = 0.5, size=15,face="bold"),
      legend.key.size = unit(1,"line"))

NN_202_df$MONTH_TEXT <-  factor(NN_202_df$MONTH_TEXT, levels=unique(NN_202_df$MONTH_TEXT))
ggplot(NN_202_df, aes(x = MONTH_TEXT, y = TRANSACTION_AMOUNT)) + 
geom_bar(stat = "summary", fun = "mean", fill='#5DADE2', color="#000000") +
ggtitle("North America MT202 Monthly Average Transaction Amount") +
xlab("Month") +
ylab("Average Transaction Amount (Thousands)") +
theme(axis.text=element_text(size=10),
      axis.title = element_text(size=10),
      plot.title = element_text(hjust = 0.5, size=15,face="bold"),
      legend.key.size = unit(1,"line")) 

EU_103_df$MONTH_TEXT <-  factor(EU_103_df$MONTH_TEXT, levels=unique(EU_103_df$MONTH_TEXT))
ggplot(EU_103_df, aes(x = MONTH_TEXT, y = TRANSACTION_AMOUNT)) + 
geom_bar(stat = "summary", fun = "mean", fill='#5DADE2', color="#000000") +
ggtitle("Europe MT103 Monthly Average Transaction Amount") +
xlab("Month") +
ylab("Average Transaction Amount (Thousands)") +
theme(axis.text=element_text(size=10),
      axis.title = element_text(size=10),
      plot.title = element_text(hjust = 0.5, size=15,face="bold"),
      legend.key.size = unit(1,"line")) 

EU_202_df$MONTH_TEXT <-  factor(EU_202_df$MONTH_TEXT, levels=unique(EU_202_df$MONTH_TEXT))
ggplot(EU_202_df, aes(x = MONTH_TEXT, y = TRANSACTION_AMOUNT)) + 
geom_bar(stat = "summary", fun = "mean", fill='#5DADE2', color="#000000") +
ggtitle("Europe MT202 Monthly Average Transaction Amount") +
xlab("Month") +
ylab("Average Transaction Amount (Thousands)") +
theme(axis.text=element_text(size=10),
      axis.title = element_text(size=10),
      plot.title = element_text(hjust = 0.5, size=15,face="bold"),
      legend.key.size = unit(1,"line")) 

AS_103_df$MONTH_TEXT <-  factor(AS_103_df$MONTH_TEXT, levels=unique(AS_103_df$MONTH_TEXT))
ggplot(AS_103_df, aes(x = MONTH_TEXT, y = TRANSACTION_AMOUNT)) + 
geom_bar(stat = "summary", fun = "mean", fill='#5DADE2', color="#000000") +
ggtitle("Asia MT103 Monthly Average Transaction Amount") +
xlab("Month") +
ylab("Average Transaction Amount (Thousands)") +
theme(axis.text=element_text(size=10),
      axis.title = element_text(size=10),
      plot.title = element_text(hjust = 0.5, size=15,face="bold"),
      legend.key.size = unit(1,"line"))  

AS_202_df$MONTH_TEXT <-  factor(AS_202_df$MONTH_TEXT, levels=unique(AS_202_df$MONTH_TEXT))
ggplot(AS_202_df, aes(x = MONTH_TEXT, y = TRANSACTION_AMOUNT)) + 
geom_bar(stat = "summary", fun = "mean", fill='#5DADE2', color="#000000") +
ggtitle("Asia MT202 Monthly Average Transaction Amount") +
xlab("Month") +
ylab("Average Transaction Amount  (Thousands)") +
theme(axis.text=element_text(size=10),
      axis.title = element_text(size=10),
      plot.title = element_text(hjust = 0.5, size=15,face="bold"),
      legend.key.size = unit(1,"line"))  

```

## **Is the data normally distributed?**

```{r p5, echo=TRUE, message=FALSE}
library(ggplot2)

input_data_eda <- input_data_eda %>%
  mutate(MONTH_TEXT = case_when(
    endsWith(TRXN_MONTH, "1") ~ "Jan",
    endsWith(TRXN_MONTH, "2") ~ "Feb",
    endsWith(TRXN_MONTH, "3") ~ "Mar",
    endsWith(TRXN_MONTH, "4") ~ "Apr",
    endsWith(TRXN_MONTH, "5") ~ "May",
    endsWith(TRXN_MONTH, "6") ~ "Jun",
    endsWith(TRXN_MONTH, "7") ~ "Jul",
    endsWith(TRXN_MONTH, "8") ~ "Aug",
    endsWith(TRXN_MONTH, "9") ~ "Sep",
    endsWith(TRXN_MONTH, "10") ~ "Oct",
    endsWith(TRXN_MONTH, "11") ~ "Nov",
    endsWith(TRXN_MONTH, "12") ~ "Dec"
    ))

input_data_eda$TRXN_MONTH = as.integer(input_data_eda$TRXN_MONTH)
input_data_eda <- input_data_eda[order(input_data_eda$TRXN_MONTH),]
input_data_eda$MONTH_TEXT <-  factor(input_data_eda$MONTH_TEXT, levels=unique(input_data_eda$MONTH_TEXT))
input_data_eda$TRANSACTION_AMOUNT=input_data_eda$TRANSACTION_AMOUNT/1000

options(repr.plot.width = 15, repr.plot.height = 10)
ggplot(input_data_eda, aes(x = MONTH_TEXT, y = TRANSACTION_AMOUNT)) + 
geom_bar(stat = "summary", fun = "mean", fill='#5DADE2', color="#000000") +
ggtitle("Monthly Average Transaction Amount") +
xlab("Month") +
ylab("Transaction Amount (Thousands)") +
theme(axis.text=element_text(size=10),
      axis.title = element_text(size=10),
      plot.title = element_text(hjust = 0.5, size=15,face="bold"),
      legend.key.size = unit(1,"line"))
```

## **Process Runtime**

```{r, echo=TRUE, message=FALSE}
end_time <- Sys.time()
end_time - start_time
```

